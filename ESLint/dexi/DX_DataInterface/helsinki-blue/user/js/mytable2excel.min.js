var idTmr;function getExplorer(){var a=window.navigator.userAgent;if(a.indexOf("MSIE")>=0){return"ie"}else{if(a.indexOf("Firefox")>=0){return"Firefox"}else{if(a.indexOf("Chrome")>=0){return"Chrome"}else{if(a.indexOf("Opera")>=0){return"Opera"}else{if(a.indexOf("Safari")>=0){return"Safari"}}}}}}function exportExcel(h){if(getExplorer()=="ie"){var a=document.getElementById(h);var f=new ActiveXObject("Excel.Application");var d=f.Workbooks.Add();var i=d.Worksheets(1);var g=document.body.createTextRange();g.moveToElementText(a);g.select();g.execCommand("Copy");i.Paste();f.Visible=true;try{var c=f.Application.GetSaveAsFilename("Excel.xls",filename)}catch(b){print("Nested catch caught "+b)}finally{d.SaveAs(c);d.Close(savechanges=false);f.Quit();f=null;idTmr=window.setInterval("Cleanup();",1)}}else{tableToExcel(h)}}function exportExcel_ForObj(h){if(getExplorer()=="ie"){var a=h;var f=new ActiveXObject("Excel.Application");var d=f.Workbooks.Add();var i=d.Worksheets(1);var g=document.body.createTextRange();g.moveToElementText(a);g.select();g.execCommand("Copy");i.Paste();f.Visible=true;try{var c=f.Application.GetSaveAsFilename("Excel.xls",filename)}catch(b){print("Nested catch caught "+b)}finally{d.SaveAs(c);d.Close(savechanges=false);f.Quit();f=null;idTmr=window.setInterval("Cleanup();",1)}}else{tableToExcel_ForObj("数据导出",h)}}function Cleanup(){window.clearInterval(idTmr);CollectGarbage()}var tableToExcel=(function(){var d="data:application/vnd.ms-excel;base64,",c='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel"xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--> <style type="text/css">.excelTable  {border-collapse:collapse; border:thin solid #999; }   .excelTable  th {   border: thin solid #999;  padding:20px;  text-align: center;  border-top: thin solid #999; background-color: #E6E6E6; } .excelTable  td{ border:thin solid #999;  padding:2px 5px;  text-align: center; }</style></head><body ><table class="excelTable">{table}</table></body></html>',a=function(e){return window.btoa(unescape(encodeURIComponent(e)))},b=function(f,e){return f.replace(/{(\w+)}/g,function(g,h){return e[h]})};return function(g,f){if(!g.nodeType){g=document.getElementById(g)}var e={worksheet:f||"Worksheet",table:g.innerHTML};document.getElementById("exportExcel").href=d+a(b(c,e));document.getElementById("exportExcel").download=filename;document.getElementById("exportExcel").click()}})();var tableToExcel_ForObj=(function(){var d="data:application/vnd.ms-excel;base64,",c='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel"xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--> <style type="text/css">.excelTable  {border-collapse:collapse; border:thin solid #999; }   .excelTable  th {   border: thin solid #999;  padding:20px;  text-align: center;  border-top: thin solid #999; background-color: #E6E6E6; } .excelTable  td{ border:thin solid #999;  padding:2px 5px;  text-align: center; }</style></head><body ><table class="excelTable">{table}</table></body></html>',a=function(e){return window.btoa(unescape(encodeURIComponent(e)))},b=function(f,e){return f.replace(/{(\w+)}/g,function(g,h){return e[h]})};return function(g,f){var e={worksheet:f||"Worksheet",table:g.innerHTML};document.getElementById("exportExcel").href=d+a(b(c,e));document.getElementById("exportExcel").download="filename";document.getElementById("exportExcel").click()}})();function Cleanup(){window.clearInterval(idTmr);CollectGarbage()};