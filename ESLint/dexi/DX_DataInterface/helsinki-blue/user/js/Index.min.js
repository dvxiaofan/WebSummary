var g_UserInfoObj=null;var g_table_id_cnt=1;var g_table_ul_cnt=1;var g_table_ul_offset=96;var g_table_ul_width=80;var g_left_right_butt_width=50;function GetUserInfo(){var a={GetFun:"GetLoginStatus",};$.ajax({url:"/Home/Login",type:"POST",dataType:"json",data:a,}).done(function(d){if(d.rel==1){g_UserInfoObj=JSON.parse(d.obj);var b=g_UserInfoObj[0];var c=new String(b.NICK_NAME);if(c==null){c="未命名的用户"}if(c.length>20){c=c.substr(0,20);c+="..."}if(IsPC()){}else{window.location.href="../Home/Mobile_Index";return}document.getElementById("nickname_id").innerHTML=c;user_ShowNotice("登录成功",c+" 您好，欢迎登录！","success",1500,false);if(b.ROLE==64){document.getElementById("user_type_id").innerHTML="普通用户"}else{if(b.ROLE==256){document.getElementById("user_type_id").innerHTML="管理员"}else{document.getElementById("user_type_id").innerHTML="未知类型"}}}else{if(d.rel==-1){layer.alert(d.msg,{icon:5,scrollbar:false});parent.JumpLogon()}else{if(d.msg!=null){user_message("sign_out_message_id","登录失败",d.msg,"default","error",null,null)}else{user_message("sign_out_message_id","登录失败","出现未知的错误，登录请求失败！","default","warning",null,null)}}}}).fail(function(){user_message("sign_out_message_id","登录失败","发送登录请求失败，请检查服务器连接状态！","default","warning",null,null);return})}function GetUserMenu(){var a={GetFun:"GetUserInfo",};$.ajax({url:"/Home/Index",type:"POST",dataType:"json",data:a,}).done(function(c){if(c.rel==1){if(c.obj!=null){var b=c.obj;$("#main-nav").append(b);$("#main-nav").trigger("create");button_on_click("li_home_1_id","li_home_id");return}}else{if(c.rel==-1){layer.alert(c.msg,{icon:5,scrollbar:false});parent.JumpLogon()}}document.getElementById("user_main_menu_id").innerHTML="菜单加载失败"}).fail(function(){document.getElementById("user_main_menu_id").innerHTML="菜单加载失败"})}function GetUserInfoCache(){return g_UserInfoObj}function button_user_info_click(){button_on_click("li_manage_1_id","li_manage_id")}function button_exit_click(){user_message("sign_out_message_id","警告","确定退出吗?","default","warning","ExitLogin",null)}function ExitLogin(){var a={GetFun:"LogoutLogin",};$.ajax({url:"/Home/Index",type:"POST",dataType:"json",data:a,}).done(function(b){if(b.rel==1){window.location.href="/Home/Login"}else{user_message("sign_out_message_id","退出登录失败","出现未知的错误，登录请求失败！","default","warning",null,null)}}).fail(function(){user_message("sign_out_message_id","退出登录失败","发送登录请求失败，请检查服务器连接状态！","default","warning",null,null);return})}function deleteTab(a){alert("删除标签页")}function get_end_li_offset(){var a=document.querySelectorAll("#user_tabs_id li");if(a==null||a.length==0){return 0}var b=a[a.length-1].offsetLeft-g_table_ul_offset+a[a.length-1].clientWidth;return b}function active_tab(d){try{$("#user_tabs_id a[href=#tab_href_"+d+"]").tab("show");var f=document.getElementById("tab_li_id_"+d);var a=document.getElementById("main_content_id");var g=(f.offsetLeft-96+f.clientWidth)-(a.clientWidth-96);if(g>0){g_table_ul_offset-=g;var b=document.getElementById("tab_ul_div_id");b.style["margin-left"]=g_table_ul_offset+"px"}}catch(c){}}function get_left_ul_width(d){var f=0;try{var a=document.querySelectorAll("#user_tabs_id li");for(var c=0;c<a.length;c++){if(a[c].id==d){return f}else{f+=a[c].clientWidth}}}catch(b){}return 0}function get_active_li_info(){var f=new Object();var g=0;f.offset=0;f.width=0;f.index=0;f.id="";f.obj=null;try{var a=document.querySelectorAll("#user_tabs_id li");for(var d=0;d<a.length;d++){var b=a[d].className;if(b!=null&&b=="active"){f.offset=g;f.width=a[d].clientWidth;f.index=d;f.id=a[d].id;f.obj=a[d];return f}g+=a[d].clientWidth}}catch(c){}return f}function user_add_tabs(d,n,g,f,e){var k='<a href="#tab_href_'+d+'" data-toggle="tab" style="color:#000000;"><i class="fa fa-file-o" aria-hidden="true">&nbsp</i>'+n+'<i>&nbsp</i><i id="delete_tab_id_'+d+'" class="fa fa-times glyphicon-remove-sign" onclick="user_delete_tabs('+d+')"></i> </a>';var l='<a href="#tab_href_'+d+'" data-toggle="tab" style="color:#000000;"><i class="fa fa-file-o" aria-hidden="true">&nbsp</i>'+n+"</a>";var b='<div class="tab-pane fade in " id="tab_href_'+d+'"  style="height:100%;width:100%"><iframe id="iframe_id_'+d+'" src="'+e+'" name="'+e+'"style="height:inherit;width:100%;" frameborder=0 ></iframe></div>';var a=document.querySelectorAll("#tab_content_id iframe");for(var c=0;c<a.length;c++){if(a[c].name==e){var j=a[c].id;active_tab(j.substr(10));RefreshTabWidth();return}}var m=document.getElementById("user_tabs_id");var h=document.createElement("li");h.setAttribute("id","tab_li_id_"+d);h.setAttribute("style","word-break:keep-all;");if(g==true){h.innerHTML=k}else{h.innerHTML=l}m.appendChild(h);$("#tab_content_id").append(b);g_table_ul_width+=(document.getElementById("tab_li_id_"+d).clientWidth);if(f){active_tab(d)}g_table_ul_cnt++;RefreshTabWidth();$('a[data-toggle="tab"]').on("shown.bs.tab",function(i){RefreshTabWidth()})}function user_delete_tabs(a){var b=$("li.active").attr("id");var c;if(b==("tab_li_id_"+a)){b=$("#tab_href_"+a).prev();if(b!=null&&b.length>0){c=b[0].id.substr(9);if(c!=null){}else{c="0"}$("#tab_li_id_"+a).remove();$("#tab_href_"+a).remove();g_table_ul_cnt--;active_tab(c);RefreshTabWidth();return}}$("#tab_li_id_"+a).remove();$("#tab_href_"+a).remove();g_table_ul_cnt--;RefreshTabWidth()}function user_left_tabs(){try{var a=document.querySelectorAll("#user_tabs_id li");for(var c=0;c<a.length;c++){if(a[c].className=="active"){if(c==0){return}var d=parseInt(a[c-1].id.substring(10),10);$("#user_tabs_id a[href=#tab_href_"+d+"]").tab("show");break}}}catch(b){}}function user_right_tabs(){try{var a=document.querySelectorAll("#user_tabs_id li");for(var c=0;c<a.length;c++){if(a[c].className=="active"){if(c==(a.length-1)){return}var d=parseInt(a[c+1].id.substring(10),10);$("#user_tabs_id a[href=#tab_href_"+d+"]").tab("show");break}}}catch(b){}};